<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Easy sashimi plot visualization — ez_sashimi • ezGenomeTracks</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Easy sashimi plot visualization — ez_sashimi"><meta name="description" content="This function creates a sashimi plot combining coverage tracks with splice junction arcs.
It is commonly used for RNA-seq data to visualize both read coverage and splicing events."><meta property="og:description" content="This function creates a sashimi plot combining coverage tracks with splice junction arcs.
It is commonly used for RNA-seq data to visualize both read coverage and splicing events."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ezGenomeTracks</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_usage.html">Basic Usage</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_usage.html">Advanced Usage</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tracks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tracks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tracks"><li><a class="dropdown-item" href="../articles/tracks_coverage.html">Coverage</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_gene.html">Gene</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_feature.html">Feature</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_link.html">Link</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_sashimi.html">Sashimi</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_manhattan.html">Manhattan</a></li>
    <li><a class="dropdown-item" href="../articles/tracks_manhattan.html">HiC</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/Zepeng-Mu/ezGenomeTracks"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Easy sashimi plot visualization</h1>
      <small class="dont-index">Source: <a href="https://github.com/Zepeng-Mu/ezGenomeTracks/blob/HEAD/R/ez_wrappers.R" class="external-link"><code>R/ez_wrappers.R</code></a></small>
      <div class="d-none name"><code>ez_sashimi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a sashimi plot combining coverage tracks with splice junction arcs.
It is commonly used for RNA-seq data to visualize both read coverage and splicing events.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ez_sashimi</span><span class="op">(</span></span>
<span>  <span class="va">coverage_data</span>,</span>
<span>  <span class="va">junction_data</span>,</span>
<span>  <span class="va">region</span>,</span>
<span>  coverage_fill <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  coverage_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  junction_direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alternate"</span>, <span class="st">"up"</span>, <span class="st">"down"</span><span class="op">)</span>,</span>
<span>  junction_curvature <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  height_factor <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  junction_color <span class="op">=</span> <span class="st">"gray50"</span>,</span>
<span>  junction_alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  score_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"identity"</span>, <span class="st">"log10"</span>, <span class="st">"sqrt"</span><span class="op">)</span>,</span>
<span>  linewidth_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  y_axis_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"simple"</span>, <span class="st">"full"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-coverage-data">coverage_data<a class="anchor" aria-label="anchor" href="#arg-coverage-data"></a></dt>
<dd><p>Coverage input: a data frame with seqnames, start, end, score columns,
or a file path to a bedGraph/bigWig file</p></dd>


<dt id="arg-junction-data">junction_data<a class="anchor" aria-label="anchor" href="#arg-junction-data"></a></dt>
<dd><p>Junction input: a data frame with seqnames, start, end, score columns,
or a file path to a BED file. start/end represent the splice junction donor/acceptor sites.</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>Genomic region to display (e.g., "chr1:1000000-2000000")</p></dd>


<dt id="arg-coverage-fill">coverage_fill<a class="anchor" aria-label="anchor" href="#arg-coverage-fill"></a></dt>
<dd><p>Fill color for coverage area. Default: "steelblue"</p></dd>


<dt id="arg-coverage-alpha">coverage_alpha<a class="anchor" aria-label="anchor" href="#arg-coverage-alpha"></a></dt>
<dd><p>Transparency for coverage area (0-1). Default: 0.5</p></dd>


<dt id="arg-junction-direction">junction_direction<a class="anchor" aria-label="anchor" href="#arg-junction-direction"></a></dt>
<dd><p>Direction of junction arcs: "alternate" (default, odd junctions up,
even down), "up" (all arcs above coverage), or "down" (all arcs below zero line)</p></dd>


<dt id="arg-junction-curvature">junction_curvature<a class="anchor" aria-label="anchor" href="#arg-junction-curvature"></a></dt>
<dd><p>Curvature of junction arcs (0-1). Higher values create more
pronounced curves. Default: 0.5</p></dd>


<dt id="arg-height-factor">height_factor<a class="anchor" aria-label="anchor" href="#arg-height-factor"></a></dt>
<dd><p>Height of arcs as proportion of genomic distance span.
Higher values create taller arcs. Default: 0.15</p></dd>


<dt id="arg-junction-color">junction_color<a class="anchor" aria-label="anchor" href="#arg-junction-color"></a></dt>
<dd><p>Color for junction arcs. Default: "gray50"</p></dd>


<dt id="arg-junction-alpha">junction_alpha<a class="anchor" aria-label="anchor" href="#arg-junction-alpha"></a></dt>
<dd><p>Transparency for junction arcs (0-1). Default: 0.7</p></dd>


<dt id="arg-score-transform">score_transform<a class="anchor" aria-label="anchor" href="#arg-score-transform"></a></dt>
<dd><p>Transformation for junction scores when mapping to line width:
"identity" (no transformation), "log10", or "sqrt". Default: "identity"</p></dd>


<dt id="arg-linewidth-range">linewidth_range<a class="anchor" aria-label="anchor" href="#arg-linewidth-range"></a></dt>
<dd><p>Range of line widths for junction arcs, mapped from score.
Default: c(0.5, 3)</p></dd>


<dt id="arg-show-labels">show_labels<a class="anchor" aria-label="anchor" href="#arg-show-labels"></a></dt>
<dd><p>Logical, whether to show score labels at arc centers. Default: TRUE</p></dd>


<dt id="arg-label-size">label_size<a class="anchor" aria-label="anchor" href="#arg-label-size"></a></dt>
<dd><p>Font size for score labels. Default: 3</p></dd>


<dt id="arg-label-color">label_color<a class="anchor" aria-label="anchor" href="#arg-label-color"></a></dt>
<dd><p>Color for score labels. Default: "black"</p></dd>


<dt id="arg-y-axis-style">y_axis_style<a class="anchor" aria-label="anchor" href="#arg-y-axis-style"></a></dt>
<dd><p>Y-axis style: "none", "simple", or "full". Default: "none"</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to geom_coverage</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object representing the sashimi plot</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Sashimi plots combine two visual elements:</p><ul><li><p>Coverage track: Shows read depth across the region as a filled area</p></li>
<li><p>Junction arcs: Connect splice donor and acceptor sites, with line width
proportional to the number of supporting reads (score)</p></li>
</ul><p>For "up" direction, arc endpoints are positioned at the coverage height at those
positions. For "down" direction, arcs extend below the zero line. The "alternate"
mode assigns alternating directions to junctions sorted by start position, which
helps reduce visual overlap.</p>
<p>Junction scores are mapped to line width using the specified transformation.
Use "log10" or "sqrt" for data with wide score ranges to prevent very thick lines.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic sashimi plot</span></span></span>
<span class="r-in"><span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  seqnames <span class="op">=</span> <span class="st">"chr1"</span>, start <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, end <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">101</span>, score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  seqnames <span class="op">=</span> <span class="st">"chr1"</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ez_sashimi</span><span class="op">(</span><span class="va">coverage</span>, <span class="va">junctions</span>, <span class="st">"chr1:1-100"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With log-transformed scores and custom colors</span></span></span>
<span class="r-in"><span><span class="fu">ez_sashimi</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">coverage</span>, <span class="va">junctions</span>, <span class="st">"chr1:1-100"</span>,</span></span>
<span class="r-in"><span>  coverage_fill <span class="op">=</span> <span class="st">"darkblue"</span>,</span></span>
<span class="r-in"><span>  junction_color <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>  score_transform <span class="op">=</span> <span class="st">"log10"</span>,</span></span>
<span class="r-in"><span>  junction_direction <span class="op">=</span> <span class="st">"up"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># From files</span></span></span>
<span class="r-in"><span><span class="fu">ez_sashimi</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"coverage.bedgraph"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"junctions.bed"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"chr1:1000000-2000000"</span>,</span></span>
<span class="r-in"><span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zepeng Mu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

