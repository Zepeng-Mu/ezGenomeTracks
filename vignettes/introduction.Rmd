---
title: "Introduction to ezGenomeTracks"
author: "ezGenomeTracks Team"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ezGenomeTracks}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 8,
  fig.height = 6
)
```

## Introduction

The `ezGenomeTracks` package provides a flexible and user-friendly framework for creating genome browser-style visualizations in R. Built on top of the popular `ggplot2` package, `ezGenomeTracks` allows users to create and stack multiple genomic data tracks, such as signal tracks, peak tracks, gene annotation tracks, and more.

## Installation

You can install the development version of `ezGenomeTracks` from GitHub with:

```{r eval=FALSE}
# install.packages("devtools")
devtools::install_github("username/ezGenomeTracks")
```

## Basic Usage

The `ezGenomeTracks` package provides a set of functions for creating different types of genomic tracks. Each track is created using a specific function, and multiple tracks can be stacked together using the `genome_plot()` function.

```{r setup}
library(ezGenomeTracks)
```

## Example Data

The package includes example datasets for demonstration purposes:

```{r}
data(example_signal)
data(example_peaks)
data(example_genes)
data(example_interactions)
data(example_hic)
```

Let's take a look at the structure of these datasets:

```{r}
head(example_signal)
head(example_peaks)
head(example_genes)
head(example_interactions)
head(example_hic)
```

## Creating Individual Tracks

### Signal Track

Signal tracks are used to visualize continuous data, such as coverage from RNA-seq or ATAC-seq experiments. The `ez_coverage()` function creates a signal track from a data frame or a bigWig file.

```{r}
# Create a signal track from the example data
signal_track <- ez_coverage(
  data = example_signal,
  fill = "steelblue",
  color = "navy",
  type = "area"
)

# Display the track
signal_track
```

### Peak Track

Peak tracks are used to visualize discrete genomic regions, such as ChIP-seq peaks or other genomic intervals. The `ez_peak()` function creates a peak track from a data frame or a BED file.

```{r}
# Create a peak track from the example data
peak_track <- ez_peak(
  data = example_peaks,
  fill = "coral",
  color = "red",
  use_score = TRUE
)

# Display the track
peak_track
```

### Gene Track

Gene tracks are used to visualize gene annotations, including exons, introns, and strand information. The `ez_gene()` function creates a gene track from a data frame or a GTF/GFF file.

```{r}
# Create a gene track from the example data
gene_track <- ez_gene(
  data = example_genes,
  fill = "darkgreen",
  color = "black"
)

# Display the track
gene_track
```

### Interaction Track

Interaction tracks are used to visualize genomic interactions, such as chromatin loops or other pairwise genomic relationships. The `ez_arc()` function creates an interaction track from a data frame or a BEDPE file.

```{r}
# Create an interaction track from the example data
interaction_track <- ez_arc(
  data = example_interactions,
  color = "purple",
  alpha = 0.7
)

# Display the track
interaction_track
```

### Hi-C Track

Hi-C tracks are used to visualize contact matrices from Hi-C experiments. The `ez_hic()` function creates a Hi-C track from a data frame or a Hi-C matrix file.

```{r}
# Create a Hi-C track from the example data
hic_track <- ez_hic(
  data = example_hic,
  low = "white",
  high = "red"
)

# Display the track
hic_track
```

## Stacking Tracks

One of the key features of `ezGenomeTracks` is the ability to stack multiple tracks together, creating a genome browser-style visualization. The `genome_plot()` function is used to stack tracks.

```{r}
# Stack the tracks
p <- genome_plot(
  signal_track,
  peak_track,
  gene_track,
  interaction_track,
  hic_track,
  heights = c(2, 1, 1.5, 1.5, 3)
)

# Display the stacked tracks
p
```

## Customizing Tracks

### Adding Annotations

You can add annotations to tracks, such as vertical lines, horizontal lines, or text labels.

```{r}
# Add a vertical line to the signal track
signal_track_with_vline <- add_vline(
  signal_track,
  position = 1050000,
  color = "red",
  linetype = "dashed"
)

# Add a horizontal line to the signal track
signal_track_with_hline <- add_hline(
  signal_track_with_vline,
  y = 10,
  color = "blue",
  linetype = "dotted"
)

# Add a rectangle to highlight a region
signal_track_with_rect <- add_rect(
  signal_track_with_hline,
  xmin = 1020000,
  xmax = 1030000,
  fill = "yellow",
  alpha = 0.3
)

# Add a text label
signal_track_with_text <- add_text(
  signal_track_with_rect,
  x = 1050000,
  y = 12,
  label = "Peak",
  color = "red"
)

# Display the annotated track
signal_track_with_text
```

### Using Themes

The package provides several themes for customizing the appearance of tracks.

```{r}
# Apply the ez_theme to the signal track
signal_track_themed <- signal_track + ez_theme()

# Apply the ez_coverage_theme to the signal track
signal_track_signal_themed <- signal_track + ez_coverage_theme()

# Apply the ez_gene_theme to the gene track
gene_track_themed <- gene_track + ez_gene_theme()

# Apply the ez_peak_theme to the peak track
peak_track_themed <- peak_track + ez_peak_theme()

# Display the themed tracks
signal_track_themed
gene_track_themed
peak_track_themed
```

## Conclusion

The `ezGenomeTracks` package provides a flexible and user-friendly framework for creating genome browser-style visualizations in R. With its intuitive API and integration with `ggplot2`, it allows users to create and customize genomic tracks with ease.

For more advanced usage and examples, please refer to the other vignettes and the package documentation.