% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ez_wrappers.R
\name{ez_sashimi}
\alias{ez_sashimi}
\title{Easy sashimi plot visualization}
\usage{
ez_sashimi(
  coverage_data,
  junction_data,
  region,
  coverage_fill = "steelblue",
  coverage_alpha = 0.5,
  junction_direction = c("alternate", "up", "down"),
  junction_curvature = 0.5,
  height_factor = 0.15,
  junction_color = "gray50",
  junction_alpha = 0.7,
  score_transform = c("identity", "log10", "sqrt"),
  linewidth_range = c(0.5, 3),
  show_labels = TRUE,
  label_size = 3,
  label_color = "black",
  y_axis_style = c("none", "simple", "full"),
  ...
)
}
\arguments{
\item{coverage_data}{Coverage input: a data frame with seqnames, start, end, score columns,
or a file path to a bedGraph/bigWig file}

\item{junction_data}{Junction input: a data frame with seqnames, start, end, score columns,
or a file path to a BED file. start/end represent the splice junction donor/acceptor sites.}

\item{region}{Genomic region to display (e.g., "chr1:1000000-2000000")}

\item{coverage_fill}{Fill color for coverage area. Default: "steelblue"}

\item{coverage_alpha}{Transparency for coverage area (0-1). Default: 0.5}

\item{junction_direction}{Direction of junction arcs: "alternate" (default, odd junctions up,
even down), "up" (all arcs above coverage), or "down" (all arcs below zero line)}

\item{junction_curvature}{Curvature of junction arcs (0-1). Higher values create more
pronounced curves. Default: 0.5}

\item{height_factor}{Height of arcs as proportion of genomic distance span.
Higher values create taller arcs. Default: 0.15}

\item{junction_color}{Color for junction arcs. Default: "gray50"}

\item{junction_alpha}{Transparency for junction arcs (0-1). Default: 0.7}

\item{score_transform}{Transformation for junction scores when mapping to line width:
"identity" (no transformation), "log10", or "sqrt". Default: "identity"}

\item{linewidth_range}{Range of line widths for junction arcs, mapped from score.
Default: c(0.5, 3)}

\item{show_labels}{Logical, whether to show score labels at arc centers. Default: TRUE}

\item{label_size}{Font size for score labels. Default: 3}

\item{label_color}{Color for score labels. Default: "black"}

\item{y_axis_style}{Y-axis style: "none", "simple", or "full". Default: "none"}

\item{...}{Additional arguments passed to geom_coverage}
}
\value{
A ggplot2 object representing the sashimi plot
}
\description{
This function creates a sashimi plot combining coverage tracks with splice junction arcs.
It is commonly used for RNA-seq data to visualize both read coverage and splicing events.
}
\details{
Sashimi plots combine two visual elements:
\itemize{
\item Coverage track: Shows read depth across the region as a filled area
\item Junction arcs: Connect splice donor and acceptor sites, with line width
proportional to the number of supporting reads (score)
}

For "up" direction, arc endpoints are positioned at the coverage height at those
positions. For "down" direction, arcs extend below the zero line. The "alternate"
mode assigns alternating directions to junctions sorted by start position, which
helps reduce visual overlap.

Junction scores are mapped to line width using the specified transformation.
Use "log10" or "sqrt" for data with wide score ranges to prevent very thick lines.
}
\examples{
\dontrun{
# Basic sashimi plot
coverage <- data.frame(
  seqnames = "chr1", start = 1:100, end = 2:101, score = c(runif(30, 5, 10),
    rep(0, 20), runif(50, 5, 10))
)
junctions <- data.frame(
  seqnames = "chr1", start = c(30), end = c(50), score = c(15)
)
ez_sashimi(coverage, junctions, "chr1:1-100")

# With log-transformed scores and custom colors
ez_sashimi(
  coverage, junctions, "chr1:1-100",
  coverage_fill = "darkblue",
  junction_color = "red",
  score_transform = "log10",
  junction_direction = "up"
)

# From files
ez_sashimi(
  "coverage.bedgraph",
  "junctions.bed",
  "chr1:1000000-2000000",
  show_labels = TRUE
)
}
}
