% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom_gene.R
\docType{data}
\name{geom_gene}
\alias{geom_gene}
\alias{GeomGene}
\title{Geom for gene model tracks}
\usage{
geom_gene(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  height = NULL,
  exon_height = 0.4,
  intron_width = 0.4,
  arrow_length = 0,
  arrow_type = "open",
  exon_color = "gray50",
  exon_fill = "gray50",
  intron_color = "gray50",
  clip_to_region = NULL,
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)
}
\arguments{
\item{mapping}{Set of aesthetic mappings created by \code{\link[=aes]{aes()}}.}

\item{data}{The data to be displayed in this layer.}

\item{stat}{The statistical transformation to use on the data.}

\item{position}{Position adjustment, either as a string, or the result of
a call to a position adjustment function.}

\item{...}{Other arguments passed on to \code{\link[=layer]{layer()}}. These are often
aesthetics, used to set an aesthetic to a fixed value, like
\code{color = "red"} or \code{size = 3}.}

\item{height}{Height of gene tracks for discrete y-axis. If \code{NULL} (default),
uses the \code{exon_height} parameter to determine track height.}

\item{exon_height}{Height of exons relative to track height. A numeric value
between 0 and 1. Default: 0.75}

\item{intron_width}{Line width for intron segments. Default: 0.4}

\item{arrow_length}{Length of directional arrows in inches. Set to 0 to
disable arrows. Default: 0}

\item{arrow_type}{Type of arrow head. See \code{\link[grid:arrow]{grid::arrow()}} for options.
Default: "open"}

\item{exon_color}{Default border color for exons. Can be overridden by
\code{color} or \code{colour} aesthetics. Default: "gray50"}

\item{exon_fill}{Default fill color for exons. Can be overridden by \code{fill}
aesthetic. Default: "gray50"}

\item{intron_color}{Default color for intron lines. Can be overridden by
\code{color} or \code{colour} aesthetics. Default: "gray50"}

\item{clip_to_region}{Optional numeric vector of length 2 specifying the
genomic region boundaries (start, end) to clip features to. Features
partially overlapping the region will be trimmed. Default: NULL}

\item{na.rm}{If \code{FALSE}, the default, missing values are removed with
a warning. If \code{TRUE}, missing values are silently removed.}

\item{show.legend}{Logical. Should this layer be included in the legends?
\code{NA} (the default) includes the layer in the legends if any aesthetics
are mapped.}

\item{inherit.aes}{If \code{FALSE}, overrides the default aesthetics, rather
than combining with them.}
}
\value{
A ggplot2 layer that can be added to a plot.
}
\description{
\code{geom_gene} provides a flexible way to visualize gene models in genomic coordinates.
It can display exons, introns, and strand information, with automatic handling
of gene structure and strand separation.
}
\details{
The \code{GeomGene} ggproto object implements the core functionality for rendering gene models.
It handles both the data processing and the actual drawing of gene features.

Key features:
\itemize{
\item Automatically processes input data to handle different input formats
\item Manages the coordinate transformation for proper genomic scaling
\item Handles the rendering of both exons and introns with appropriate styling
\item Supports strand-specific visualization with optional directional arrows
\item Implements proper handling of missing values and edge cases
}
}
\section{Aesthetics}{

The following aesthetics are required:
\itemize{
\item \code{xstart}: Start position of the feature (genomic coordinate)
\item \code{xend}: End position of the feature (genomic coordinate)
\item \code{type}: Type of feature ("gene" or "exon")
}

Optional aesthetics:
\itemize{
\item \code{color}: Color for both exons (fill) and introns (color)
\item \code{fill}: Fill color for exons (overrides \code{color} for fill if specified)
\item \code{strand}: Strand information ("+" or "-")
\item \code{y}: Optional grouping variable (overrides automatic strand-based grouping)
}


The following aesthetics are used by the geom:
\itemize{
\item \code{xstart}, \code{xend}: Start and end genomic coordinates
\item \code{type}: Feature type ("gene" or "exon")
\item \code{strand}: Strand information ("+" or "-")
\item \code{y}: Optional y-axis grouping
\item \code{colour}: Color for both exons (fill) and introns (line)
\item \code{fill}: Fill color for exons (overrides \code{colour} for fill)
\item \code{linewidth}: Width of intron lines
\item \code{alpha}: Transparency (0-1)
\item \code{linetype}: Line type for introns
\item \code{size}: Size of points (unused, for compatibility)
}
}

\section{Data Format}{

The function expects a data frame with the following columns:
\itemize{
\item Required:
\itemize{
\item \code{xstart}, \code{xend}: Genomic coordinates of features
\item \code{type}: Either "gene" (for introns) or "exon"
}
\item Optional:
\itemize{
\item \code{strand}: "+" or "-" for forward/reverse strand
\item \code{exon_start}, \code{exon_end}: For long-format exon data
\item Any additional columns for aesthetics (e.g., gene names, biotypes)
}
}
}

\section{Features}{

\itemize{
\item Automatic strand separation with customizable track heights
\item Support for both wide and long data formats
\item Customizable appearance of exons and introns
\item Optional directional arrows for strand indication
\item Integration with ggplot2's theming system
}
}

\section{Methods}{

The ggproto object implements the following methods:
\itemize{
\item \code{setup_data()}: Processes input data and sets up y-axis positions
\item \code{setup_params()}: Configures drawing parameters including arrow settings
\item \code{draw_panel()}: Main drawing method that renders the gene models
\item \code{draw_key()}: Defines how to draw the legend key
}
}

\examples{
\dontrun{
library(ggplot2)

# Example 1: Basic usage with automatic strand separation
ggplot(gene_data) +
  geom_gene(aes(
    xstart = start, xend = end,
    type = feature, color = gene_name
  ))

# Example 2: Custom y-axis grouping by biotype
ggplot(gene_data) +
  geom_gene(aes(
    xstart = start, xend = end,
    type = feature, y = biotype,
    fill = gene_name
  ))

# Example 3: Styling options
ggplot(gene_data) +
  geom_gene(
    aes(xstart = start, xend = end, type = feature),
    exon_fill = "steelblue",
    exon_color = "navy",
    intron_color = "darkblue",
    intron_width = 0.6,
    exon_height = 0.8,
    arrow_length = unit(0.05, "inches")
  )
}
}
\keyword{datasets}
